<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微信小程序内嵌webview 遇到的问题总结 | 前端知识体库</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/img/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.b71a9117.css" as="style"><link rel="preload" href="/assets/js/app.3649875f.js" as="script"><link rel="preload" href="/assets/js/2.fe84df1e.js" as="script"><link rel="preload" href="/assets/js/8.e3eef520.js" as="script"><link rel="prefetch" href="/assets/js/10.69f3024b.js"><link rel="prefetch" href="/assets/js/11.3c9f76fa.js"><link rel="prefetch" href="/assets/js/12.85dbeff8.js"><link rel="prefetch" href="/assets/js/13.9683359d.js"><link rel="prefetch" href="/assets/js/14.2cabde5e.js"><link rel="prefetch" href="/assets/js/15.2c2784b6.js"><link rel="prefetch" href="/assets/js/16.fd483a46.js"><link rel="prefetch" href="/assets/js/17.87ad3e80.js"><link rel="prefetch" href="/assets/js/18.904234b2.js"><link rel="prefetch" href="/assets/js/19.1607e2ef.js"><link rel="prefetch" href="/assets/js/20.8f8148fa.js"><link rel="prefetch" href="/assets/js/21.8b5f748e.js"><link rel="prefetch" href="/assets/js/22.b2cc5637.js"><link rel="prefetch" href="/assets/js/23.84ddc723.js"><link rel="prefetch" href="/assets/js/24.54859964.js"><link rel="prefetch" href="/assets/js/25.0f3cbb8c.js"><link rel="prefetch" href="/assets/js/26.47560d0c.js"><link rel="prefetch" href="/assets/js/27.f778fe2f.js"><link rel="prefetch" href="/assets/js/28.eb137b8b.js"><link rel="prefetch" href="/assets/js/29.c5e83008.js"><link rel="prefetch" href="/assets/js/3.cc802162.js"><link rel="prefetch" href="/assets/js/30.a3760b76.js"><link rel="prefetch" href="/assets/js/31.a8ae5170.js"><link rel="prefetch" href="/assets/js/32.12b9e7cf.js"><link rel="prefetch" href="/assets/js/33.b8c7564e.js"><link rel="prefetch" href="/assets/js/34.dbb3897a.js"><link rel="prefetch" href="/assets/js/35.a8986c3d.js"><link rel="prefetch" href="/assets/js/36.4513de15.js"><link rel="prefetch" href="/assets/js/37.770f4e3a.js"><link rel="prefetch" href="/assets/js/38.2dcfb5b5.js"><link rel="prefetch" href="/assets/js/39.e9a2c546.js"><link rel="prefetch" href="/assets/js/4.c67d8aad.js"><link rel="prefetch" href="/assets/js/40.8fdb2cfb.js"><link rel="prefetch" href="/assets/js/41.f3ee0f68.js"><link rel="prefetch" href="/assets/js/42.e079f9a8.js"><link rel="prefetch" href="/assets/js/43.a27897f2.js"><link rel="prefetch" href="/assets/js/44.e1e9dc34.js"><link rel="prefetch" href="/assets/js/45.613e67ba.js"><link rel="prefetch" href="/assets/js/46.ebea46a3.js"><link rel="prefetch" href="/assets/js/47.bb3d124f.js"><link rel="prefetch" href="/assets/js/48.546d069b.js"><link rel="prefetch" href="/assets/js/5.88b3679e.js"><link rel="prefetch" href="/assets/js/6.a67e17b0.js"><link rel="prefetch" href="/assets/js/7.4c8a2fd2.js"><link rel="prefetch" href="/assets/js/9.ff33e87e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b71a9117.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="前端知识体库" class="logo"> <span class="site-name can-hide">前端知识体库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  每日一鲜
</a></div><div class="nav-item"><a href="/blog.html" class="nav-link">
  博客/会议
</a></div><div class="nav-item"><a href="https://juejin.im/timeline" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://time.geekbang.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  极客时间
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.vuepress.cn/guide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vuepress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://developer.mozilla.org/zh-CN/docs/Web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/wuzaofeng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/xitu/gold-miner" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金翻译计划
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://voice.baidu.com/act/newpneumonia/newpneumonia/?from=osari_pc_3" target="_blank" rel="noopener noreferrer" class="nav-link external">
  疫情实时
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  每日一鲜
</a></div><div class="nav-item"><a href="/blog.html" class="nav-link">
  博客/会议
</a></div><div class="nav-item"><a href="https://juejin.im/timeline" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://time.geekbang.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  极客时间
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.vuepress.cn/guide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vuepress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://developer.mozilla.org/zh-CN/docs/Web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/wuzaofeng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/xitu/gold-miner" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金翻译计划
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://voice.baidu.com/act/newpneumonia/newpneumonia/?from=osari_pc_3" target="_blank" rel="noopener noreferrer" class="nav-link external">
  疫情实时
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/guide/" class="sidebar-link">自动化部署静态文档</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>学习笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learning/html/" class="sidebar-link">html</a></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learning/css/select/" class="sidebar-link">CSS选择器笔记</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learning/javascript/deep/" class="sidebar-link">重学JS</a></li><li><a href="/learning/javascript/deep/es6.html" class="sidebar-link">重学es6</a></li><li><a href="/learning/javascript/function.html" class="sidebar-link">模拟方法</a></li><li><a href="/learning/javascript/expression.html" class="sidebar-link">什么是表达式语句</a></li><li><a href="/learning/javascript/extends.html" class="sidebar-link">js继承的方法以及优缺点</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>设计模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learning/design/create.html" class="sidebar-link">设计模式(创建设计模式)</a></li><li><a href="/learning/design/struct.html" class="sidebar-link">设计模式(结构化设计模式)</a></li><li><a href="/learning/design/behaviour.html" class="sidebar-link">设计模式(行为型设计模式)</a></li><li><a href="/learning/design/book.html" class="sidebar-link">推荐设计模式书籍</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learning/vue2/" class="sidebar-link">vue2</a></li><li><a href="/learning/vue3.html" class="sidebar-link">vue3</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learning/typescript/ts-collection-question.html" class="sidebar-link">【好文】耗时一年整理，全网最全的TypeScript踩坑集锦 (纯 TS 问题)</a></li><li><a href="/learning/typescript/ts-collection-config.html" class="sidebar-link">【好文】耗时一年整理，全网最全的TypeScript踩坑集锦 (tsconfig.json 常用配置项注释)</a></li><li><a href="/learning/typescript/ts-collection-react.html" class="sidebar-link">【好文】耗时一年整理，全网最全的TypeScript踩坑集锦（React + TS 项目问题）</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>前端工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learning/project/webpack/" class="sidebar-link">【好文】企业级 Webpack 分享总结</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>读书笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readBook/HighPerformanceJS/" class="sidebar-link">高性能javascript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>工作笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/working/wechat/webview.html" class="active sidebar-link">微信小程序内嵌webview问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#业务域名" class="sidebar-link">业务域名</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#涉及到的第三方链接" class="sidebar-link">涉及到的第三方链接</a></li><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#小程序内嵌webview分为两种" class="sidebar-link">小程序内嵌webview分为两种</a></li><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#解决方案" class="sidebar-link">解决方案</a></li><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#微信文章" class="sidebar-link">微信文章</a></li><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#涉及到的网址" class="sidebar-link">涉及到的网址</a></li></ul></li><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#由于内嵌webview，没有返回按钮，怎么办" class="sidebar-link">由于内嵌webview，没有返回按钮，怎么办</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#提出问题" class="sidebar-link">提出问题</a></li><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#解决方案-2" class="sidebar-link">解决方案</a></li></ul></li><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#小程序跳转到公众号" class="sidebar-link">小程序跳转到公众号</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/working/wechat/webview.html#解决方案-3" class="sidebar-link">解决方案</a></li></ul></li></ul></li><li><a href="/working/verdaccio.html" class="sidebar-link">verdaccio 指南</a></li><li><a href="/working/webpack/" class="sidebar-link">vue-cli3项目构建优化</a></li><li><a href="/working/nethall/first-paint.html" class="sidebar-link">网厅首屏优化</a></li><li><a href="/working/nethall/home-bug/" class="sidebar-link">网厅首页开发问题笔记</a></li><li><a href="/working/nethall/validate-code/" class="sidebar-link">验证码封装组件</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>面试笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/job/html.html" class="sidebar-link">HTML面试题</a></li><li><a href="/job/css/" class="sidebar-link">CSS面试题</a></li><li><a href="/job/js.html" class="sidebar-link">JS面试题</a></li><li><a href="/job/browser.html" class="sidebar-link">浏览器面试题</a></li><li><a href="/job/description.html" class="sidebar-link">原理面试题</a></li><li><a href="/job/frame.html" class="sidebar-link">框架面试题</a></li><li><a href="/job/vue/" class="sidebar-link">vue面试题</a></li><li><a href="/job/way/" class="sidebar-link">前端面试之道的理解</a></li><li><a href="/job/project.html" class="sidebar-link">工程类面试</a></li></ul></section></li><li><a href="/cracked.html" class="sidebar-link">工具破解链接</a></li><li><a href="https://ustbhuangyi.github.io/vue-analysis/v2/prepare/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Vue.js 技术揭秘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="微信小程序内嵌webview-遇到的问题总结"><a href="#微信小程序内嵌webview-遇到的问题总结" class="header-anchor">#</a> 微信小程序内嵌webview 遇到的问题总结</h1> <div class="custom-block tip"><p class="custom-block-title">前言</p> <p>由于我的项目都是由web页面搭建的，突然有一天项目经理说需要搭建一个与该项目一摸一样的微信小程序
如果重新开发的话，那花费的成本会很大，我浏览了一下微信小程序文档发现，可以通过webview来内嵌小程序来实现
这样避免了需要重复开发相同代码</p></div> <h2 id="业务域名"><a href="#业务域名" class="header-anchor">#</a> 业务域名</h2> <h3 id="涉及到的第三方链接"><a href="#涉及到的第三方链接" class="header-anchor">#</a> 涉及到的第三方链接</h3> <ul><li>阿里云图片地址（该项目用到的是阿里云的oss）(图片显示)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>xyzq<span class="token operator">-</span><span class="token keyword">static</span><span class="token punctuation">.</span>oss<span class="token operator">-</span>cn<span class="token operator">-</span>shenzhen<span class="token punctuation">.</span>aliyuncs<span class="token punctuation">.</span>com
</code></pre></div><ul><li>七鱼地址（引用在本地）(在线客服)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">/</span><span class="token keyword">static</span><span class="token operator">/</span>js<span class="token operator">/</span>qiyunkf<span class="token punctuation">.</span>js
</code></pre></div><ul><li>高德地图地址(仅用于通用业务获取定位)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>webapi<span class="token punctuation">.</span>amap<span class="token punctuation">.</span>com<span class="token operator">/</span>maps<span class="token operator">?</span>v<span class="token operator">=</span><span class="token number">1.4</span><span class="token number">.15</span><span class="token operator">&amp;</span>key<span class="token operator">=</span>cbfc0b347323de3f78edf4145a93df26
</code></pre></div><ul><li>微信公众号文章地址(查看微信公众号文章（入金-办理香港银行卡指南))</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mp<span class="token punctuation">.</span>weixin<span class="token punctuation">.</span>qq<span class="token punctuation">.</span>com<span class="token operator">/</span>mp<span class="token operator">/</span>homepage<span class="token operator">?</span>__biz<span class="token operator">=</span>Mzg3MDIzNjE4Mg<span class="token operator">==</span><span class="token operator">&amp;</span>hid<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>sn<span class="token operator">=</span>ff409e4abd09e7a510b2fe995ddea933
</code></pre></div><ul><li>获取客户端的ip(获取客户端的ip)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>pv<span class="token punctuation">.</span>sohu<span class="token punctuation">.</span>com<span class="token operator">/</span>cityjson<span class="token operator">?</span>ie<span class="token operator">=</span>utf<span class="token operator">-</span><span class="token number">8</span>
</code></pre></div><ul><li>无痕验证地址(无痕验证)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>g<span class="token punctuation">.</span>alicdn<span class="token punctuation">.</span>com<span class="token operator">/</span>sd<span class="token operator">/</span>nvc<span class="token operator">/</span><span class="token number">1.1</span><span class="token number">.112</span><span class="token operator">/</span>guide<span class="token punctuation">.</span>js<span class="token operator">?</span><span class="token number">2019062501</span>
</code></pre></div><h3 id="小程序内嵌webview分为两种"><a href="#小程序内嵌webview分为两种" class="header-anchor">#</a> 小程序内嵌webview分为两种</h3> <ul><li>第三方纯js文件</li></ul> <ol><li><strong>高德地图地址</strong>(仅用于通用业务获取定位)</li> <li><strong>获取客户端的ip</strong>(获取客户端的ip)</li> <li><strong>无痕验证地址</strong>(无痕验证)</li></ol> <ul><li>需要链接的地址（这就是所谓的业务域名）</li></ul> <ol><li><strong>阿里云图片地址</strong></li> <li><strong>七鱼客服地址</strong></li></ol> <h3 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h3> <ul><li>第三方纯js文件无需解决</li> <li>阿里云图片地址也是<strong>上传文件</strong>，在根路径上传<strong>校验文件</strong></li> <li>七鱼客服地址，在其后台上传<strong>校验文件</strong></li></ul> <h3 id="微信文章"><a href="#微信文章" class="header-anchor">#</a> 微信文章</h3> <p>小程序需要关联公众号
但目前来说微信模版不能访问，但微信文章详情可以访问
可以访问微信详情的<strong>图片，视频</strong>，最好使用4g网络来访问</p> <p>公众号可<strong>关联10个同主体</strong>，<strong>3个非同主体</strong>小程序</p> <p>一个小程序<strong>可关联500个公众号</strong></p> <p>解决方案</p> <ul><li>在<strong>业务项目</strong>做一个类似微信模版的页面，然后通过webview跳转</li> <li>可以在<strong>微信文章详情</strong>编辑成一个类似微信模版的页面。</li></ul> <h4 id="相关链接"><a href="#相关链接" class="header-anchor">#</a> 相关链接</h4> <p><a href="https://mp.weixin.qq.com/mp/homepage?__biz=Mzg3MDIzNjE4Mg==&amp;hid=2&amp;sn=ff409e4abd09e7a510b2fe995ddea933?session=DIAjvdk2WuwTEQUcFC3Tw2AKK&amp;platformType=miniProgram#wechat_redirect" target="_blank" rel="noopener noreferrer">页面模版(不可访问)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://mp.weixin.qq.com/s?__biz=Mzg3MDIzNjE4Mg==&amp;mid=100000516&amp;idx=2&amp;sn=1e1ebb56d838d5a86197bc53c03949ea&amp;scene=19#wechat_redirect" target="_blank" rel="noopener noreferrer">微信文章详情(关联后可访问)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://developers.weixin.qq.com/community/develop/doc/000ea261644c705e0ff6316865c000" target="_blank" rel="noopener noreferrer">微信小程序 web-view打开公众号 页面模板文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="custom-block tip"><p class="custom-block-title">总结</p> <p>之前在这里踩了很多坑，引用在线客服会报(没有配置业务域名) 错误
实际上经过我一个个js文件测试发现。业务域名值的是地址链接，而不包括js文件
七鱼客服 js会动态生成iframe,src这个地址，导致七鱼需要配置校验文件
阿里云是需要打开图片
微信文章的话只能打开微信详情</p></div> <h3 id="涉及到的网址"><a href="#涉及到的网址" class="header-anchor">#</a> 涉及到的网址</h3> <p><a href="https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html" target="_blank" rel="noopener noreferrer">微信webview组件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="由于内嵌webview，没有返回按钮，怎么办"><a href="#由于内嵌webview，没有返回按钮，怎么办" class="header-anchor">#</a> 由于内嵌webview，没有返回按钮，怎么办</h2> <h3 id="提出问题"><a href="#提出问题" class="header-anchor">#</a> 提出问题</h3> <p>内嵌webview，登录之后进入首页，首页点击其他页面，需要打开原生小程序页面，才会显示返回箭头</p> <h3 id="解决方案-2"><a href="#解决方案-2" class="header-anchor">#</a> 解决方案</h3> <ul><li>打开webview地址，可以传入一个标识，让应用来识别是从小程序打开</li> <li>引入<a href="//res2.wx.qq.com/open/js/jweixin-1.4.0.js">微信sdk</a></li> <li>当点击需要跳转的时候，调用微信小程序方法  window.wx.miniProgram.navigateTo</li></ul> <h4 id="相关代码"><a href="#相关代码" class="header-anchor">#</a> 相关代码</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">checkIsMiniProgram</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'platformType'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'platformType'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'miniProgram'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">wxNavigateTo</span> <span class="token punctuation">(</span><span class="token parameter">object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>wx <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>wx<span class="token punctuation">.</span>miniProgram<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>wx<span class="token punctuation">.</span>miniProgram<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 微信小程序跳转</span>
<span class="token comment">/**
 * 两种情况
 * 1.直接传入字符串，默认是地址
 * 2.如果是对象, params里面可包含路由对象，第二个参数是微信小程序跳转的参数
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">navigateTo</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token punctuation">,</span> wxParams <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> session <span class="token operator">=</span> storage<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'session'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> params <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 只是传入地址</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkIsMiniProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?session=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>session<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token function">wxNavigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../webview/webview?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      location<span class="token punctuation">.</span>href <span class="token operator">=</span> params
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> params <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> path<span class="token punctuation">,</span> <span class="token operator">...</span>routeParams <span class="token punctuation">}</span> <span class="token operator">=</span> params
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkIsMiniProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>origin <span class="token operator">+</span> path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?session=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>session<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token function">wxNavigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../webview/webview?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token operator">...</span>wxParams
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        path<span class="token punctuation">,</span>
        <span class="token operator">...</span>routeParams
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>小程序代码，创建webview页面，来接收地址</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webview.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/\?/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      url <span class="token operator">+=</span> <span class="token string">'&amp;platformType=miniProgram#wechat_redirect'</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      url <span class="token operator">+=</span> <span class="token string">'?platformType=miniProgram#wechat_redirect'</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> url
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="小程序跳转到公众号"><a href="#小程序跳转到公众号" class="header-anchor">#</a> 小程序跳转到公众号</h2> <p>由于官方不直接支持跳转到公众号</p> <p>由于我们需要指引关注的公众号有两个，一个是投教服务，一个是兴业证券，而且又是嵌套webview的界面，所以通过原生组件的方式来实现
需要跳转两次，webview跳转到原生组件，然后通过原生组件跳转到公众号</p> <h3 id="解决方案-3"><a href="#解决方案-3" class="header-anchor">#</a> 解决方案</h3> <ol><li>通过组件来实现</li></ol> <ul><li>official-account
配置关注的公众号，而且只能选择<strong>一个</strong>公众号
小程序主体和公众号主体需要一致
需要小程序打开公众号关注组件权限</li></ul> <p><strong>使用场景限制</strong></p> <ol><li><p>当小程序从扫<strong>小程序码场景</strong>（场景值1047，场景值1124）打开时</p></li> <li><p>当小程序从<strong>聊天顶部场景</strong>（场景值1089）中的「最近使用」内打开时，若小程序之前未被销毁，则该组件保持上一次打开小程序时的状态</p></li> <li><p>当从<strong>其他小程序返回小程序</strong>（场景值1038）时，若小程序之前未被销毁，则该组件保持上一次打开小程序时的状态</p></li></ol> <p><img src="/assets/img/1.35465f36.jpg" alt="1"> <img src="/assets/img/2.af49c9e8.jpg" alt="2"> <img src="/assets/img/3.6fcf0588.jpg" alt="3"></p> <ul><li>通过客服消息</li></ul> <p>进去消息，自动回复，需要服务器支持</p> <p>做个指引，让客户手动关联公众号
<img src="/assets/img/4.dc264957.jpg" alt="4"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/readBook/HighPerformanceJS/" class="prev">
        高性能javascript
      </a></span> <span class="next"><a href="/working/verdaccio.html">
        verdaccio 指南
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3649875f.js" defer></script><script src="/assets/js/2.fe84df1e.js" defer></script><script src="/assets/js/8.e3eef520.js" defer></script>
  </body>
</html>
